# 产品需求说明（SearchEvery 桌面端）

## 1. 产品定位
一款跨平台（Windows/macOS/Linux）的本地文件搜索与管理工具，面向个人与专业用户，提供高性能的全文检索、近似语义搜索、以及重复文件识别与清理。

## 2. 目标用户与场景
- 目标用户：内容创作者、程序员、学生/研究者、企业员工。
- 主要场景：
  - 全盘快速检索文件、文档内容、代码片段；
  - 图片/音频/视频的名称检索或在开启 AI 时的自动识别检索；
  - 查找并清理重复/近似重复文件，释放空间；
  - 离线使用，隐私保护优先。

## 3. 范围与优先级
- P0：倒排索引检索、中文分词、混合搜索、重复文件识别、基础设置。
- P1：PDF/Office/OFD 解析、OCR/ASR 可选开启、向量数据库可配置。
- P2：语义增强（图像描述、视频关键帧识别）、多语言界面、主题适配。

## 4. 关键功能与需求详情
4.1 索引构建
- 扫描所有分区与挂载点；默认排除系统目录（可配置）。
- 倒排索引：
  - 文本文件：索引文件名 + 内容；
  - 可提取文件（pdf/word/excel/ppt/ofd）：索引文件名 + 提取内容；
  - 图片/语音/小视频：默认索引文件名；开启大模型时进行识别文本并加入索引；
  - 其他二进制：索引文件名；
  - 权重：默认 10；文件名 80；标题 一级 60/二级 40/三级 20。
- 中文分词：jieba，支持用户词典与停用词管理。

4.2 向量索引与配置
- 向量数据库：Milvus/ChromaDB/LanceDB，用户可配置地址、鉴权、集合参数。
- 构建对象：图片、语音、小视频、二进制文件（利用文件名或识别文本/特征）。
- 嵌入模型：可嵌入本地（Ollama/开源）或云端厂商；支持维度与度量配置。

4.3 大模型接入配置
- 当前版本：默认关闭且暂不接入；保留配置入口（说明文案与关闭状态）。
- 预留字段：地址/Endpoint、API Key、模型名、温度、并发度、超时（后续版本启用）。
- 功能（后续）：图片图像描述、语音识别增强、视频关键帧识别等。

4.4 搜索功能
- 默认模式：仅倒排；用户可切换“倒排+向量混合”或“仅向量”（需先配置嵌入与向量库）。
- 查询支持：关键词、短语、布尔操作（AND/OR/NOT）、文件类型/大小/时间过滤。
- 展示：结果列表（名称、路径、类型、摘要、权重说明、高亮片段）；详情侧栏（预览/打开位置）。
- 性能：本地搜索结果 200ms 内返回（已建立索引）。

4.5 重复文件识别与清理
- 识别：精确重复（哈希），近似重复（图片 pHash、音频指纹、视频关键帧 pHash、文本 simhash）。
- 展示：分组列表、容量占用、删除建议；
- 删除：多重确认、回收站；支持忽略规则与白名单。

4.6 设置中心
- 索引：目录白/黑名单、文件类型、最大大小、并发度、后台构建策略。
- 模型：厂商/地址/API Key/模型/温度配置；开启/关闭；
- 向量库：类型与地址、集合参数、维度与度量；
- 高级：日志级别、缓存大小、GPU 使用、代理设置。

## 5. 交互流程（核心）
1) 首次启动
- 欢迎页 → 选择要扫描的目录/分区 → 查看预计耗时 → 开始构建索引。
2) 检索
- 输入关键词 → 选择检索模式（默认混合） → 查看结果 → 打开/定位文件 → 可加入收藏/标签。
3) 重复文件清理
- 扫描 → 分组结果 → 选择保留规则（最新/最大/所在目录）→ 一键清理 → 回收站可恢复。
4) 设置
- 配置模型与向量库 → 测试连接 → 保存 → 后台重建相关索引。

## 6. 非功能性需求
- 性能：百万级文件索引；检索延迟 <200ms（缓存命中）；
- 资源：后台低优先级；用户可控并发与限速；
- 稳定性：异常重试、断点续建、数据库一致性校验；
- 安全与隐私：默认本地；云端需显式授权；脱敏日志；
- 跨平台：Windows 10+/macOS 12+/主流 Linux 发行版；
- 质量：单元/集成测试覆盖核心管线；

## 7. 边界与约束
- 不索引与删除系统关键目录；
- 不提供云盘/网络磁盘的远程索引（后期可扩展）；
- 大模型处理默认关闭，避免成本与隐私风险；
- OFD 支持在早期版本可能有限，采用回退转换保证可用性。

## 8. 成功指标（KPI）
- 构建速度：每分钟可解析文件数；
- 检索效果：Top-10 相关度满意度；
- 重复清理：释放空间与误删率；
- 稳定性：崩溃率与错误率；

## 9. 发布与版本计划
- v0.1：核心索引与检索；Windows 首发。
- v0.2：解析增强与重复扫描；
- v0.3：向量索引与混合搜索；
- v0.4：AI 增强与跨平台打包；